import objectMapper from './helper/object-mapper'
import JXONTree from './helper/jxon-tree'
import VAST from './vast'

export default function parseFromXML (xml, option = {}) {
  return objectMapper(JXONTree.fromXML(xml, option)).to(VAST).shift()
}

var stringXML = '<?xml version="1.0" encoding="UTF-8" ?><VAST version="2.0"><Ad id="4BFBDFE33EDE8B60"><Wrapper><AdSystem version="1.0">AdServer</AdSystem><VASTAdTagURI><![CDATA[http://ads111.vertamedia.com/vast/?adid=4BFBDFE33EDE8B60&aid=38051&cb=1212063394]]></VASTAdTagURI><Error><![CDATA[http://autotest.com/error?content_id=&format=&site_id=5&metrics=&site_full_url=blautotestglobal.com&deal_id=]]></Error><Impression><![CDATA[http://ads111.vertamedia.com/tracking/impression/?adid=4BFBDFE33EDE8B60]]></Impression><Impression><![CDATA[http://autotest.com/impression?content_id=&player_id=&type=&slot=&region=51&city=698740&country=UA&media=&format=&site_id=5&metrics=&site_full_url=blautotestglobal.com&deal_id=&cmp=10731&aid=38051&advId=19050&channelId=17822]]></Impression><Creatives><Creative><Linear><TrackingEvents><Tracking event="creativeView"><![CDATA[http://ads111.vertamedia.com/tracking/event/?adid=4BFBDFE33EDE8B60&code=52]]></Tracking><Tracking event="start"><![CDATA[http://ads111.vertamedia.com/tracking/event/?adid=4BFBDFE33EDE8B60&code=53]]></Tracking><Tracking event="midpoint"><![CDATA[http://ads111.vertamedia.com/tracking/event/?adid=4BFBDFE33EDE8B60&code=54]]></Tracking><Tracking event="midpoint"><![CDATA[http://autotest.com/midpoint?content_id=&format=&site_id=5&metrics=&site_full_url=blautotestglobal.com&deal_id=]]></Tracking><Tracking event="firstQuartile"><![CDATA[http://ads111.vertamedia.com/tracking/event/?adid=4BFBDFE33EDE8B60&code=55]]></Tracking><Tracking event="firstQuartile"><![CDATA[http://autotest.com/first?content_id=&format=&site_id=5&metrics=&site_full_url=blautotestglobal.com&deal_id=]]></Tracking><Tracking event="thirdQuartile"><![CDATA[http://ads111.vertamedia.com/tracking/event/?adid=4BFBDFE33EDE8B60&code=56]]></Tracking><Tracking event="thirdQuartile"><![CDATA[http://autotest.com/third?content_id=&format=&site_id=5&metrics=&site_full_url=blautotestglobal.com&deal_id=]]></Tracking><Tracking event="complete"><![CDATA[http://ads111.vertamedia.com/tracking/event/?adid=4BFBDFE33EDE8B60&code=57]]></Tracking><Tracking event="complete"><![CDATA[http://autotest.com/complete?content_id=&format=&site_id=5&metrics=&site_full_url=blautotestglobal.com&deal_id=]]></Tracking><Tracking event="mute"><![CDATA[http://ads111.vertamedia.com/tracking/event/?adid=4BFBDFE33EDE8B60&code=58]]></Tracking><Tracking event="mute"><![CDATA[http://autotest.com/mute?content_id=&format=&site_id=5&metrics=&site_full_url=blautotestglobal.com&deal_id=]]></Tracking><Tracking event="unmute"><![CDATA[http://ads111.vertamedia.com/tracking/event/?adid=4BFBDFE33EDE8B60&code=59]]></Tracking><Tracking event="unmute"><![CDATA[http://autotest.com/unmute?content_id=&format=&site_id=5&metrics=&site_full_url=blautotestglobal.com&deal_id=]]></Tracking><Tracking event="pause"><![CDATA[http://ads111.vertamedia.com/tracking/event/?adid=4BFBDFE33EDE8B60&code=60]]></Tracking><Tracking event="pause"><![CDATA[http://autotest.com/pause?content_id=&format=&site_id=5&metrics=&site_full_url=blautotestglobal.com&deal_id=&cmp=10731&aid=38051&advId=19050&channelId=17822&age=&gender=]]></Tracking><Tracking event="rewind"><![CDATA[http://ads111.vertamedia.com/tracking/event/?adid=4BFBDFE33EDE8B60&code=61]]></Tracking><Tracking event="resume"><![CDATA[http://ads111.vertamedia.com/tracking/event/?adid=4BFBDFE33EDE8B60&code=62]]></Tracking><Tracking event="resume"><![CDATA[http://autotest.com/resume?content_id=&format=&site_id=5&metrics=&site_full_url=blautotestglobal.com&deal_id=]]></Tracking><Tracking event="fullscreen"><![CDATA[http://ads111.vertamedia.com/tracking/event/?adid=4BFBDFE33EDE8B60&code=63]]></Tracking><Tracking event="expand"><![CDATA[http://ads111.vertamedia.com/tracking/event/?adid=4BFBDFE33EDE8B60&code=64]]></Tracking><Tracking event="collapse"><![CDATA[http://ads111.vertamedia.com/tracking/event/?adid=4BFBDFE33EDE8B60&code=65]]></Tracking><Tracking event="skip"><![CDATA[http://ads111.vertamedia.com/tracking/event/?adid=4BFBDFE33EDE8B60&code=66]]></Tracking><Tracking event="skip"><![CDATA[http://autotest.com/skip?content_id=&format=&site_id=5&metrics=&site_full_url=blautotestglobal.com&deal_id=]]></Tracking><Tracking event="closeLinear"><![CDATA[http://ads111.vertamedia.com/tracking/event/?adid=4BFBDFE33EDE8B60&code=67]]></Tracking></TrackingEvents><VideoClicks><ClickTracking><![CDATA[http://ads111.vertamedia.com/tracking/event/?adid=4BFBDFE33EDE8B60&code=71]]></ClickTracking><ClickTracking><![CDATA[http://autotest.com/clickthrough?content_id=&format=&site_id=5&metrics=&site_full_url=blautotestglobal.com&deal_id=&ua=Mozilla%2F5.0+%28X11%3B+Linux+x86_64%29+AppleWebKit%2F537.36+%28KHTML%2C+like+Gecko%29+Chrome%2F62.0.3202.94+Safari%2F537.36&cmp=10731&aid=38051&advId=19050&channelId=17822]]></ClickTracking></VideoClicks></Linear></Creative></Creatives></Wrapper></Ad></VAST>'

console.log(parseFromXML(stringXML))
